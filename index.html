<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="Parcours guid√© de r√©cup√©ration vocale pour personnes souffrant de dysarthrie">
    <meta name="theme-color" content="#2C3E50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Out of Dysarthria">

    <title>Out of Dysarthria</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="assets/icons/icon-192.png">
    <link rel="apple-touch-icon" sizes="192x192" href="assets/icons/icon-192.png">
</head>
<body>
    <!-- √âcran d'accueil -->
    <div id="screen-home" class="screen active">
        <header class="app-header">
            <h1 class="app-title">Out of Dysarthria</h1>
        </header>

        <main class="screen-content">
            <div class="home-icon">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M40 10C40 10 25 20 25 35C25 45 31.7 52 40 52C48.3 52 55 45 55 35C55 20 40 10 40 10Z" stroke="#2C3E50" stroke-width="3" fill="none"/>
                    <ellipse cx="40" cy="60" rx="15" ry="8" stroke="#2C3E50" stroke-width="3" fill="none"/>
                    <path d="M25 60C25 60 30 68 40 68C50 68 55 60 55 60" stroke="#2C3E50" stroke-width="3" fill="none"/>
                </svg>
            </div>

            <div class="home-description" style="max-width: 600px; margin: var(--spacing-xl) auto; padding: 0 var(--spacing-lg); text-align: center;">
                <h2 style="font-size: 1.5rem; font-weight: 600; color: var(--color-text); margin-bottom: var(--spacing-lg);">
                    Bienvenue dans votre parcours de r√©cup√©ration vocale
                </h2>

                <div style="text-align: left; background: var(--color-card-bg); padding: var(--spacing-lg); border-radius: var(--border-radius-md); margin-bottom: var(--spacing-lg);">
                    <p style="line-height: 1.6; color: var(--color-text-secondary); margin-bottom: var(--spacing-md);">
                        <strong>Out of Dysarthria</strong> vous accompagne √©tape par √©tape avec des exercices adapt√©s √† vos besoins :
                        voyelles, consonnes, syllabes, mots, phrases et exercices de souffle.
                    </p>
                    <p style="line-height: 1.6; color: var(--color-text-secondary);">
                        L'application s'adapte automatiquement √† vos difficult√©s et sauvegarde votre progression pour reprendre √† tout moment.
                    </p>
                </div>

                <div style="text-align: left; background: #E8F5E9; padding: var(--spacing-lg); border-radius: var(--border-radius-md); border-left: 4px solid #27AE60;">
                    <h3 style="font-size: 1.1rem; font-weight: 600; color: #27AE60; margin-bottom: var(--spacing-sm);">
                        ‚ú® Conseils
                    </h3>
                    <ul style="line-height: 1.8; color: #2C3E50; padding-left: var(--spacing-lg); margin: 0;">
                        <li>Trouvez un endroit calme</li>
                        <li>Pratiquez r√©guli√®rement, m√™me 10 minutes par jour</li>
                        <li>Utilisez "√áa ne marche pas" pour obtenir un parcours adapt√©</li>
                    </ul>
                </div>
            </div>

            <div class="home-actions">
                <div style="display: flex; align-items: center; justify-content: center; gap: var(--spacing-sm); width: 100%;">
                    <button id="btn-start" class="btn btn-primary" style="flex: 1;">Commencer le parcours</button>
                    <button id="btn-settings" class="btn-icon" title="Param√®tres">‚öôÔ∏è</button>
                </div>
                <button id="btn-resume" class="btn btn-secondary" style="display: none;">Reprendre</button>
            </div>

            <div id="last-session-info" class="info-text" style="display: none;">
                <!-- Sera rempli dynamiquement -->
            </div>
        </main>
    </div>

    <!-- √âcran d'exercice -->
    <div id="screen-exercise" class="screen">
        <header class="exercise-header">
            <button id="btn-abandon" class="btn-text btn-danger">‚Üê Abandonner</button>
            <div id="timer-display" class="timer">00:00</div>
        </header>

        <div class="progress-bar-container">
            <div class="progress-info">
                <span id="step-number">√âtape 1/8</span>
            </div>
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
            </div>
        </div>

        <main class="screen-content exercise-content">
            <h2 id="step-title" class="step-title">Voyelles isol√©es</h2>
            <p id="step-instruction" class="step-instruction">Prononcez chaque voyelle clairement</p>

            <div id="step-content" class="step-content">
                <!-- Contenu dynamique selon l'√©tape -->
            </div>
        </main>

        <footer class="exercise-actions">
            <button id="btn-done" class="btn btn-primary">C'est fait ‚úì</button>
            <button id="btn-repeat" class="btn btn-secondary">R√©p√©ter</button>
            <button id="btn-not-working" class="btn btn-text" style="margin-top: var(--spacing-sm);">√áa ne marche pas</button>
        </footer>
    </div>

    <!-- √âcran de fin -->
    <div id="screen-completion" class="screen">
        <header class="app-header">
            <h1 class="app-title">Out of Dysarthria</h1>
        </header>

        <main class="screen-content completion-content">
            <div class="completion-icon">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="40" cy="40" r="35" stroke="#27AE60" stroke-width="3" fill="none"/>
                    <path d="M25 40L35 50L55 30" stroke="#27AE60" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>

            <h2 class="completion-title">Parcours termin√©</h2>

            <div class="completion-stats">
                <p class="stat-item">
                    <span class="stat-label">Dur√©e:</span>
                    <span id="total-duration" class="stat-value">--</span>
                </p>
            </div>

            <div class="completion-actions">
                <button id="btn-finish" class="btn btn-primary">Terminer</button>
            </div>

            <a href="#" id="link-feedback" class="link-subtle">Comment s'est pass√© ce parcours ?</a>
        </main>
    </div>

    <!-- Modale de confirmation d'abandon -->
    <div id="modal-abandon" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <h3 class="modal-title">Abandonner le parcours ?</h3>
            <p class="modal-text">Votre progression sera sauvegard√©e et vous pourrez reprendre plus tard.</p>
            <div class="modal-actions">
                <button id="btn-cancel-abandon" class="btn btn-secondary">Annuler</button>
                <button id="btn-confirm-abandon" class="btn btn-danger">Abandonner</button>
            </div>
        </div>
    </div>

    <!-- V2.0: √âcran de statistiques -->
    <div id="screen-statistics" class="screen">
        <header class="app-header">
            <button id="btn-stats-back" class="btn-text">‚Üê Retour</button>
            <h1 class="app-title">Statistiques</h1>
        </header>

        <main class="screen-content">
            <div id="stats-content">
                <!-- Contenu dynamique g√©n√©r√© par statistics.js -->
            </div>
        </main>
    </div>

    <!-- V2.0: √âcran de r√©glages -->
    <div id="screen-settings" class="screen">
        <header class="app-header">
            <button id="btn-settings-back" class="btn-text">‚Üê Retour</button>
            <h1 class="app-title">Param√®tres</h1>
        </header>

        <main class="screen-content">
            <div id="settings-content" style="max-width: 600px; margin: 0 auto; padding: var(--spacing-lg);">
                <!-- Menu principal des param√®tres -->
                <div class="settings-menu">
                    <button id="btn-choose-parcours" class="settings-menu-item">
                        <div class="icon">üéØ</div>
                        <div class="content">
                            <div class="title">Choix du parcours</div>
                            <div class="description">S√©lectionnez vos parcours favoris</div>
                        </div>
                        <div class="arrow">‚Üí</div>
                    </button>

                    <button id="btn-view-stats" class="settings-menu-item">
                        <div class="icon">üìä</div>
                        <div class="content">
                            <div class="title">Statistiques</div>
                            <div class="description">Consultez vos progr√®s et performances</div>
                        </div>
                        <div class="arrow">‚Üí</div>
                    </button>

                    <button id="btn-reset-partial" class="settings-menu-item">
                        <div class="icon">üîÑ</div>
                        <div class="content">
                            <div class="title">R√©initialisation partielle</div>
                            <div class="description">Effacer l'historique des sessions</div>
                        </div>
                        <div class="arrow">‚Üí</div>
                    </button>

                    <button id="btn-reset-total" class="settings-menu-item warning">
                        <div class="icon">‚ö†Ô∏è</div>
                        <div class="content">
                            <div class="title">R√©initialisation totale</div>
                            <div class="description">Effacer toutes les donn√©es</div>
                        </div>
                        <div class="arrow">‚Üí</div>
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- V2.0: √âcran de choix du parcours -->
    <div id="screen-parcours-choice" class="screen">
        <header class="app-header">
            <button id="btn-parcours-back" class="btn-text">‚Üê Retour</button>
            <h1 class="app-title">Choix du parcours</h1>
        </header>

        <main class="screen-content">
            <div id="parcours-content" style="max-width: 600px; margin: 0 auto; padding: var(--spacing-lg);">
                <!-- Parcours favoris -->
                <div class="settings-section">
                    <h3 class="settings-title">Parcours favoris</h3>
                    <p class="settings-description">S√©lectionnez les parcours que vous utilisez le plus souvent</p>
                    <div class="checkbox-group">
                        <!-- COMPLETS -->
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-standard" value="standard">
                            <span>Standard</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-renforcement-global" value="renforcement-global">
                            <span>Renforcement global</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-session-courte" value="session-courte">
                            <span>Session courte</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-complet" value="tabata-complet">
                            <span>Complet (105 exercices)</span>
                        </label>

                        <!-- FONCTION -->
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-detente" value="detente-laryngee">
                            <span>D√©tente laryng√©e</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-relachement" value="relachement-musculaire">
                            <span>Rel√¢chement musculaire</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-souffle" value="souffle">
                            <span>Souffle</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-voix-resonance" value="voix-resonance">
                            <span>Voix et R√©sonance</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-voisement" value="voisement">
                            <span>Voisement</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-articulation" value="articulation">
                            <span>Articulation</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-deglutition" value="deglutition">
                            <span>D√©glutition</span>
                        </label>

                        <!-- ANATOMIE -->
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-levres" value="levres">
                            <span>L√®vres</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-langue" value="langue">
                            <span>Langue</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-machoire" value="machoire">
                            <span>M√¢choire</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-joues" value="joues">
                            <span>Joues</span>
                        </label>

                        <!-- DIVERS -->
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-economie" value="mode-economie">
                            <span>Mode √©conomie</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-modifie" value="standard-modifie">
                            <span>Standard modifi√©</span>
                        </label>
                    </div>
                </div>

                <!-- Dur√©e par √©tape -->
                <div class="settings-section">
                    <h3 class="settings-title">Dur√©e par d√©faut des √©tapes</h3>
                    <p class="settings-description">Temps pour chaque exercice</p>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="step-duration" value="20">
                            <span>Rapide (15-20s)</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="step-duration" value="30">
                            <span>Normal (30s) - Recommand√©</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="step-duration" value="60">
                            <span>Lent (60s)</span>
                        </label>
                    </div>
                </div>

                <!-- Suggestions -->
                <div class="settings-section">
                    <h3 class="settings-title">Suggestions intelligentes</h3>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="pref-suggestions">
                            <span>Afficher les suggestions de parcours bas√©es sur l'historique</span>
                        </label>
                    </div>
                </div>

                <!-- Actions -->
                <div class="settings-actions" style="margin-top: var(--spacing-2xl);">
                    <button id="btn-save-settings" class="btn btn-primary">Enregistrer</button>
                </div>
            </div>
        </main>
    </div>

    <!-- V2.0: Modale de diagnostic -->
    <div id="modal-diagnostic" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="diagnostic-menu">
                <h3 class="title">Quel type de difficult√© ?</h3>

                <div id="diagnostic-options">
                    <div class="diagnostic-option" data-blockage="ventricular">
                        <div class="icon">üòì</div>
                        <div class="content">
                            <div class="name">Bandes ventriculaires</div>
                            <div class="description">Vibrations parasites</div>
                            <div class="parcours-name">‚Üí D√©tente laryng√©e</div>
                        </div>
                    </div>

                    <div class="diagnostic-option" data-blockage="spasticity">
                        <div class="icon">üí™</div>
                        <div class="content">
                            <div class="name">Spasticit√© musculaire</div>
                            <div class="description">Muscles trop tendus</div>
                            <div class="parcours-name">‚Üí Rel√¢chement musculaire</div>
                        </div>
                    </div>

                    <div class="diagnostic-option" data-blockage="fatigue">
                        <div class="icon">üò¥</div>
                        <div class="content">
                            <div class="name">Fatigue importante</div>
                            <div class="description">Manque d'√©nergie</div>
                            <div class="parcours-name">‚Üí Mode √©conomie</div>
                        </div>
                    </div>

                    <div class="diagnostic-option" data-blockage="unknown">
                        <div class="icon">üåÄ</div>
                        <div class="content">
                            <div class="name">Autre / Ne sais pas</div>
                            <div class="description">Parcours standard modifi√©</div>
                            <div class="parcours-name">‚Üí Standard modifi√©</div>
                        </div>
                    </div>
                </div>

                <div class="modal-actions" style="margin-top: var(--spacing-xl);">
                    <button id="btn-cancel-diagnostic" class="btn btn-secondary">Annuler</button>
                    <button id="btn-confirm-diagnostic" class="btn btn-primary" disabled>Confirmer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- V2.0: √âcran d'onboarding -->
    <div id="screen-onboarding" class="screen">
        <div id="onboarding-content" class="onboarding-step">
            <!-- Contenu dynamique g√©n√©r√© par ui.js -->
        </div>
    </div>

    <!-- V2.0: Modale de feedback et notation -->
    <div id="modal-feedback" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="feedback-modal">
                <h3 class="title">Comment s'est pass√© ce parcours ?</h3>

                <div class="rating-section">
                    <p class="subtitle">Notez votre exp√©rience</p>
                    <div class="star-rating" id="star-rating">
                        <span class="star" data-rating="1">‚òÖ</span>
                        <span class="star" data-rating="2">‚òÖ</span>
                        <span class="star" data-rating="3">‚òÖ</span>
                        <span class="star" data-rating="4">‚òÖ</span>
                        <span class="star" data-rating="5">‚òÖ</span>
                    </div>
                    <div class="rating-label" id="rating-label">Cliquez pour noter</div>
                </div>

                <div class="comment-section">
                    <label for="feedback-comment">Commentaire (optionnel)</label>
                    <textarea
                        id="feedback-comment"
                        rows="4"
                        placeholder="Partagez votre exp√©rience, difficult√©s rencontr√©es, suggestions..."></textarea>
                </div>

                <div class="modal-actions">
                    <button id="btn-cancel-feedback" class="btn btn-secondary">Passer</button>
                    <button id="btn-submit-feedback" class="btn btn-primary" disabled>Envoyer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- V2.0: Banni√®re de suggestion (cach√©e par d√©faut) -->
    <div id="suggestion-banner" class="suggestion-banner" style="display: none; position: fixed; top: var(--spacing-lg); left: var(--spacing-lg); right: var(--spacing-lg); z-index: var(--z-header);">
        <div class="icon">üí°</div>
        <div class="content">
            <div class="title">Suggestion</div>
            <div class="description" id="suggestion-text"></div>
        </div>
        <div class="actions">
            <button id="btn-accept-suggestion" class="btn">Utiliser</button>
            <button id="btn-dismiss-suggestion" class="btn btn-dismiss">Non merci</button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/parcours.js"></script>
    <script src="js/parcours-router.js"></script>
    <script src="js/suggestions.js"></script>
    <script src="js/statistics.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/timer.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('‚úÖ Service Worker enregistr√©:', registration.scope);
                    })
                    .catch((error) => {
                        console.error('‚ùå Erreur Service Worker:', error);
                    });
            });
        }
    </script>
</body>
</html>
